Attribute VB_Name = "CodageTexte"
Dim Shared Code(3, 94) As String
Public Function CoderTexte(Texte As String, DéCode As Boolean) As String
Dim NumTable As Integer, Ascii As Integer, Mot As String
    
    ' Charge la table
    Chargement
    
    For i% = 1 To Len(Texte)
        ' Change la table de caractères utilisée
        NumTable = NumTable + 1
        If NumTable = 3 Then NumTable = 1
        
        ' Donne le caractère ascii
        Ascii = Asc(Mid(Texte, i%, 1)) - 32
        
        ' Donne la lettre codée par la table
        Lettre = CodeLettre(Ascii, NumTable, DéCode)
        
        ' L'ajoute au mot
        Mot = Mot + Lettre
    Next
    CoderTexte = Mot
End Function
Private Function CodeLettre(Ascii As Integer, NumTable As Integer, DéCode As Boolean) As String
Dim CodeAscii As Integer
    
    ' Code la lettre avec la table
    Select Case Ascii
    
        ' Si le caractère est ds la table
        Case 0 To 94
        
            If DéCode = False Then
                ' Code
                For i% = 0 To 94
                    CodeAscii = Asc(Code(NumTable, i%)) - 32
                    If Ascii = CodeAscii Then
                        CodeLettre = Chr(i% + 32)
                        Exit Function
                    End If
                Next
                ' Si il ne le trouve pas
                CodeLettre = Chr(Ascii + 32)
            Else
                ' Décode
                CodeLettre = Code(NumTable, Ascii)
            End If
        
        ' Si il n'est pas dedans
        Case Else
            CodeLettre = Chr(Ascii + 32)
    End Select
End Function
Private Sub Chargement()
    ' Charge les tables
    Code(1, 0) = "("
    Code(1, 1) = "5"
    Code(1, 2) = "-"
    Code(1, 3) = "6"
    Code(1, 4) = "T"
    Code(1, 5) = "7"
    Code(1, 6) = "O"
    Code(1, 7) = "8"
    Code(1, 8) = "'"
    Code(1, 9) = "4"
    Code(1, 10) = """"
    Code(1, 11) = "D"
    Code(1, 12) = "2"
    Code(1, 13) = "&"
    Code(1, 14) = "M"
    Code(1, 15) = ">"
    Code(1, 16) = "9"
    Code(1, 17) = "!"
    Code(1, 18) = "0"
    Code(1, 19) = "A"
    Code(1, 20) = "`"
    Code(1, 21) = "["
    Code(1, 22) = "z"
    Code(1, 23) = "\"
    Code(1, 24) = "K"
    Code(1, 25) = "^"
    Code(1, 26) = "~"
    Code(1, 27) = "@"
    Code(1, 28) = "$"
    Code(1, 29) = ")"
    Code(1, 30) = "]"
    Code(1, 31) = "%"
    Code(1, 32) = "}"
    Code(1, 33) = "i"
    Code(1, 34) = "o"
    Code(1, 35) = "p"
    Code(1, 36) = "R"
    Code(1, 37) = "e"
    Code(1, 38) = "Z"
    Code(1, 39) = "a"
    Code(1, 40) = ";"
    Code(1, 41) = "."
    Code(1, 42) = "h"
    Code(1, 43) = "C"
    Code(1, 44) = "+"
    Code(1, 45) = "="
    Code(1, 46) = "*"
    Code(1, 47) = "/"
    Code(1, 48) = " "
    Code(1, 49) = "g"
    Code(1, 50) = "q"
    Code(1, 51) = "W"
    Code(1, 52) = "s"
    Code(1, 53) = "X"
    Code(1, 54) = "d"
    Code(1, 55) = ","
    Code(1, 56) = "f"
    Code(1, 57) = "V"
    Code(1, 58) = "?"
    Code(1, 59) = "B"
    Code(1, 60) = ":"
    Code(1, 61) = "N"
    Code(1, 62) = "Q"
    Code(1, 63) = "w"
    Code(1, 64) = "S"
    Code(1, 65) = "x"
    Code(1, 66) = "3"
    Code(1, 67) = "c"
    Code(1, 68) = "F"
    Code(1, 69) = "v"
    Code(1, 70) = "G"
    Code(1, 71) = "b"
    Code(1, 72) = "H"
    Code(1, 73) = "n"
    Code(1, 74) = "J"
    Code(1, 75) = "j"
    Code(1, 76) = "#"
    Code(1, 77) = "k"
    Code(1, 78) = "l"
    Code(1, 79) = "m"
    Code(1, 80) = "1"
    Code(1, 81) = "L"
    Code(1, 82) = "|"
    Code(1, 83) = "P"
    Code(1, 84) = "_"
    Code(1, 85) = "I"
    Code(1, 86) = "{"
    Code(1, 87) = "E"
    Code(1, 88) = "R"
    Code(1, 89) = "<"
    Code(1, 90) = "Y"
    Code(1, 91) = "U"
    Code(1, 92) = "t"
    Code(1, 93) = "y"
    Code(1, 94) = "u"
    
    Code(2, 0) = ","
    Code(2, 1) = ";"
    Code(2, 2) = "A"
    Code(2, 3) = "!"
    Code(2, 4) = "U"
    Code(2, 5) = "?"
    Code(2, 6) = "."
    Code(2, 7) = "$"
    Code(2, 8) = "0"
    Code(2, 9) = "9"
    Code(2, 10) = "f"
    Code(2, 11) = "1"
    Code(2, 12) = "c"
    Code(2, 13) = "g"
    Code(2, 14) = "6"
    Code(2, 15) = "+"
    Code(2, 16) = "D"
    Code(2, 17) = "/"
    Code(2, 18) = "-"
    Code(2, 19) = " "
    Code(2, 20) = """"
    Code(2, 21) = "&"
    Code(2, 22) = "'"
    Code(2, 23) = "4"
    Code(2, 24) = "j"
    Code(2, 25) = "#"
    Code(2, 26) = "{"
    Code(2, 27) = "["
    Code(2, 28) = "|"
    Code(2, 29) = "a"
    Code(2, 30) = "`"
    Code(2, 31) = "_"
    Code(2, 32) = "\"
    Code(2, 33) = "^"
    Code(2, 34) = "@"
    Code(2, 35) = ")"
    Code(2, 36) = "]"
    Code(2, 37) = "8"
    Code(2, 38) = "}"
    Code(2, 39) = "="
    Code(2, 40) = "E"
    Code(2, 41) = "q"
    Code(2, 42) = "s"
    Code(2, 43) = "d"
    Code(2, 44) = "5"
    Code(2, 45) = "3"
    Code(2, 46) = "h"
    Code(2, 47) = "n"
    Code(2, 48) = "b"
    Code(2, 49) = "v"
    Code(2, 50) = "2"
    Code(2, 51) = "x"
    Code(2, 52) = "w"
    Code(2, 53) = "<"
    Code(2, 54) = "("
    Code(2, 55) = "k"
    Code(2, 56) = "l"
    Code(2, 57) = "m"
    Code(2, 58) = "P"
    Code(2, 59) = "O"
    Code(2, 60) = "I"
    Code(2, 61) = "%"
    Code(2, 62) = "Y"
    Code(2, 63) = "T"
    Code(2, 64) = "R"
    Code(2, 65) = "7"
    Code(2, 66) = "Z"
    Code(2, 67) = ":"
    Code(2, 68) = ">"
    Code(2, 69) = "W"
    Code(2, 70) = "Q"
    Code(2, 71) = "S"
    Code(2, 72) = "X"
    Code(2, 73) = "C"
    Code(2, 74) = "*"
    Code(2, 75) = "F"
    Code(2, 76) = "V"
    Code(2, 77) = "B"
    Code(2, 78) = "G"
    Code(2, 79) = "N"
    Code(2, 80) = "H"
    Code(2, 81) = "J"
    Code(2, 82) = "M"
    Code(2, 83) = "L"
    Code(2, 84) = "K"
    Code(2, 85) = "z"
    Code(2, 86) = "~"
    Code(2, 87) = "t"
    Code(2, 88) = "R"
    Code(2, 89) = "y"
    Code(2, 90) = "u"
    Code(2, 91) = "i"
    Code(2, 92) = "o"
    Code(2, 93) = "p"
    Code(2, 94) = "e"
    
    Code(3, 0) = " "
    Code(3, 1) = "&"
    Code(3, 2) = "1"
    Code(3, 3) = "<"
    Code(3, 4) = ">"
    Code(3, 5) = "a"
    Code(3, 6) = "A"
    Code(3, 7) = "q"
    Code(3, 8) = "Q"
    Code(3, 9) = "w"
    Code(3, 10) = "W"
    Code(3, 11) = "2"
    Code(3, 12) = "~"
    Code(3, 13) = "z"
    Code(3, 14) = "Z"
    Code(3, 15) = "s"
    Code(3, 16) = "S"
    Code(3, 17) = """"
    Code(3, 18) = "3"
    Code(3, 19) = "#"
    Code(3, 20) = "x"
    Code(3, 21) = "X"
    Code(3, 22) = "e"
    Code(3, 23) = "E"
    Code(3, 24) = "d"
    Code(3, 25) = "D"
    Code(3, 26) = "c"
    Code(3, 27) = "C"
    Code(3, 28) = "4"
    Code(3, 29) = "M"
    Code(3, 30) = "{"
    Code(3, 31) = "R"
    Code(3, 32) = "R"
    Code(3, 33) = "f"
    Code(3, 34) = "v"
    Code(3, 35) = "F"
    Code(3, 36) = "V"
    Code(3, 37) = "5"
    Code(3, 38) = "["
    Code(3, 39) = "("
    Code(3, 40) = "t"
    Code(3, 41) = "b"
    Code(3, 42) = "g"
    Code(3, 43) = "B"
    Code(3, 44) = "G"
    Code(3, 45) = "T"
    Code(3, 46) = "|"
    Code(3, 47) = "6"
    Code(3, 48) = "-"
    Code(3, 49) = "Y"
    Code(3, 50) = "N"
    Code(3, 51) = "H"
    Code(3, 52) = "y"
    Code(3, 53) = "h"
    Code(3, 54) = "n"
    Code(3, 55) = "7"
    Code(3, 56) = "`"
    Code(3, 57) = "u"
    Code(3, 58) = "U"
    Code(3, 59) = "J"
    Code(3, 60) = "j"
    Code(3, 61) = ","
    Code(3, 62) = "?"
    Code(3, 63) = "8"
    Code(3, 64) = "_"
    Code(3, 65) = "\"
    Code(3, 66) = "i"
    Code(3, 67) = "K"
    Code(3, 68) = "k"
    Code(3, 69) = "I"
    Code(3, 70) = "l"
    Code(3, 71) = "p"
    Code(3, 72) = "m"
    Code(3, 73) = "o"
    Code(3, 74) = "L"
    Code(3, 75) = "'"
    Code(3, 76) = "P"
    Code(3, 77) = "O"
    Code(3, 78) = "9"
    Code(3, 79) = "0"
    Code(3, 80) = "^"
    Code(3, 81) = "@"
    Code(3, 82) = "."
    Code(3, 83) = "/"
    Code(3, 84) = "!"
    Code(3, 85) = ":"
    Code(3, 86) = ";"
    Code(3, 87) = "%"
    Code(3, 88) = "*"
    Code(3, 89) = "$"
    Code(3, 90) = ")"
    Code(3, 91) = "]"
    Code(3, 92) = "="
    Code(3, 93) = "}"
    Code(3, 94) = "+"
End Sub
